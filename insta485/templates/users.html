<!DOCTYPE html>
<html lang="en"> <!--if not logged in then every page should link to login page per spec--> 
    <head>
  <title>Insta485</title>
</head>
<body> <!--images could use fixing of lcoations into var/-->
  <h1>Page of {{ username }}</h1>
  <a href="{{ url_for('show_index') }}">Main Page</a>
  <a href="{{ url_for('show_explore') }}">Go to Explore</a> <!--if logged in then link to explore page--> 
  <a href="{{ url_for('show_user', username=logname)}}">Link to Page of {{ logname }}</a> <!--if logged in then link to profile page--> 
  {% if logname == username %}
    <a href="{{ url_for('edit_account') }}">Edit profile</a>

    <form action="{{ url_for('logout')}}" method="post" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="submit" name="logout" value="Logout"/>
    </form>

    <!-- DO NOT CHANGE THIS (aside from where we say 'FIXME') -->
    <form action="{{ url_for('update_posts') }}?target={{ url_for('show_user', username=logname) }}" method="post" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="file" name="file" accept="image/*" required/>
      <input type="submit" name="create_post" value="upload new post"/>
      <input type="hidden" name="operation" value="create"/>
    </form>

    {% endif %}
  {% if does_logname_follow_user %}
    <nav>
      <p>following</p>
      <form action="{{ url_for('update_following') }}?target={{ url_for('show_user', username=username) }}" method="post" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="submit" name="unfollow" value="unfollow"/>
        <input type="hidden" name="username" value="{{ username }}"/>
        <input type="hidden" name="operation" value="unfollow"/>
    </form>
    </nav>

    {% else %}
      {% if username != logname %}
        <nav>
        <p>not following</p>
        <form action="{{ url_for('update_following') }}?target={{ url_for('show_user', username=username) }}" method="post" enctype="multipart/form-data">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <input type="submit" name="follow" value="follow"/>
          <input type="hidden" name="username" value="{{ username }}"/>
          <input type="hidden" name="operation" value="follow"/>
        </form>
      </nav>
      {% endif %}
    {% endif %}

    <div class="followers">
      <a href="{{ url_for('show_user_followers', username=username) }}">
      <p>{{ num_followers }} {{ "follower" if num_followers == 1 else "followers" }}</p>
      </a>
    </div>


    <div class="following">
      <a href="{{ url_for('show_user_following', username=username) }}">
      <p>{{ num_following }} following</p>
      </a>
    </div>   

    <p>{{ num_posts }} {{ "post" if num_posts == 1 else "posts" }}</p>

    <p>{{ fullname }}</p>

    {% if posts %}
      {% for post in posts %}
        <div class="post">
          <a href="{{ url_for('show_post', postid=post['postid']) }}">
            <img src="{{ url_for('upload_file', filename=post['filename']) }}"
            alt="{{ post['postid'] }} "></a>
        </div>
      {% endfor %}
    {% else %}
      <p>No posts yet.</p>
    {% endif %}



  </body>
  </html>